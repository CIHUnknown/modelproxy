# 数据接口 Mock（river-mock）

> by 玄道<xuandao.ws@tmall.com>

river-mock 为满足数据接口规范（[river-spec][spec]）的数据定义生成 Mock 数据，充分利用了 JSON Schema 的描述能力。

## 0. 安装

0. 安装 tnpm：`npm install -g tnpm`
0. 卸载 npm 版 river-mock（如安装过）： `tnpm uninstall -g river-mock`
0. 安装 river-mock： `tnpm install -g river-mock`

## 1. API

0. spec2mock(schema)
    0. 将普通的 schema 对象进行生成 mock
    0. return {object}

0. schema2mock(spec, req)
    * 将符合 [river-spec][spec] 标准的 json 进行生成 mock 数据
    * arguments: 
        0. spec{object}
        0. req{string|object},规则如下
            0. 若 req 为空，则返回 response
            0. 若 req 为字符串，则返回 req
            0. 若 req 为对象，则使用[算法规则](http://gitlab.alibaba-inc.com/river/spec/blob/master/README.md#responsemap)进行匹配
                0. 若 req 为 http request 对象，则自动获取 url、method 与 responseMap 进行匹配
                0. 若 req 位 object时
                   * 结构: {query: {search: 'xxx'}, method: 'GET'}
                   * query: url 参数列表
                   * method: http 请求方法
    * return {object};

## 2. 参考
0. [responseMap](http://gitlab.alibaba-inc.com/river/spec/tree/master#responsemap)
0. [随机生成规则](http://work.tmall.net/issues/13857)

## 3. 共建

0. 提[issue](http://gitlab.alibaba-inc.com/river/mock/issues)

[spec]: http://gitlab.alibaba-inc.com/river/spec