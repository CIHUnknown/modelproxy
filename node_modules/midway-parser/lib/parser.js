function parse( obj, variables, symbol ) {
    if ( typeof obj === 'object' || obj instanceof Array ) {
        for ( var i in obj ) {
            obj[i] = parse( obj[i], variables, symbol );
        }
    }
    if ( typeof obj === 'string' ) {
        symbol = symbol || '$';
        var reg = new RegExp( '\\' + symbol + '.+\\' + symbol, 'g' );
        return obj.replace( reg, function( s ) {
            var name = s.split('$')[1];
            var namePath = name.split( '.' );
            var val = variables;
            for ( var i = 0; i < namePath.length; i++ ) {
                val = val[ namePath[i] ];
                if ( typeof val === 'undefined' ) {
                    throw new Error( 'Can not find variable ' + s );
                }
            }
            return val;
        } );
    }
    return obj;
}

exports.parse = parse;